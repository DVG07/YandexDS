Целью данного аналитического проекта является разработка решения, которое позволит персонализировать предложения постоянным клиентам для увеличения их покупательской активности.

Заказчик: интернет-магазин "В один клик", занимающейся продажей разных товаров (от детских до бытовой техники и продуктов).

Большая часть целевой аудитории уже осведомлена о магазине, в связи с чем проблематично увеличить продажи за счет привлечения новых клиентов.

Предварительно необходимо:

Промаркировать уровень финансовой активности постоянных покупателей (снизилась, если клиент покупает меньше товаров, или прежний уровень).
Сгруппировать данные по клиентам по следующим категориям:
Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.
После необходимо:

Построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.
Включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.
Используя данные модели и данные о прибыльности клиентов, выделить сегменты покупателей и разработать для них персонализированные предложения.

За основу были взяты 4 модели: метод k-ближайших соседей(KNeighborsClassifier), дерево решений (DecisionTreeClassifier), логистическая регрессия (LogisticRegression) и классификация опорных векторов (SVC). 
Для каждой модели подбираются, по возможности, оптимальные гиперпараметры в Пайплайне.

За основу проверки качества работы модели взята метрика roc-auc. 

Для кодирования категориальных признаков использовались 2 кодировщика: OneHotEncoder и OrdinalEncoder. 
Для масштабирования количественных признаков использовались 2 скейлера: StandardScaler, MinMaxScaler.

В результате было выявлено, что лучший результат по метрике показала модель дерева решений (DecisionTreeClassifier) с максимальной глубиной 11, количество объектов на 1 "листе" 7, а минимальное количество объектов на узле для разделения на классы - 9. 
Метрика roc_auc на тренировочных данных составила 87%, относительно высокий показатель.

По итогу оценки работы модели при кросс-валидации (cv=10) установлено, что среднее значение метрики составило 0.86, разброс от 82% до 92%.

Подведем итоги работы:

Исходыне данные содержали небольшое количество орфографических ошибок, которые были исправлены. Пропусков в данных нет. Яных дубликатов также не обнаружено.
Однако по итогам анализа выявлено наличие 4 аномальных значений (3 с аномальным количеством доли акционных товаров и с отсутствующими данными о выручке за предыдущий и препредыдущий месяца; 1 с аномально высоким показателем выручки), в итоговый датафрейм они не попали, были удалены для более корректной работы модели.
По итогу анализа данных, установлено, что почти у 40% клиентов снизился уровень покупательской активности. Предварительно сделан вывод, что ключевыми причинами может быть отсутствие акций на интересующие группы товаров, отметили снижение времени пребывания таких клиентов на сайте и различия в популярных категориях (клиенты с прежним уровнем активности больше доля товаров категории Мелкая бытовая техника и электроника, а при снижении - Косметика и аксессуары и Кухонная посуда).
По итогу корреляционного анализа гипотезу отвернуть не удалось, т.к. наблюдается линейная зависимость между долей акционных товаров, количеством неоплаченных товаров и обратная зависимость со временем на сайте (количество минут и просмотренных страниц) при наличии прямой корреляции между временем на сайте и объемом выручки.
Для поиска лучшей модели был построен пайплайн.
За основу взяли 4 модели: метод k-ближайших соседей(KNeighborsClassifier), дерево решений (DecisionTreeClassifier), логистическая регрессия (LogisticRegression) и классификация опорных векторов (SVC). Для каждой подбирались, по возможности, оптимальные гиперпараметры.
По итогу оценки 4 моделей, лучший результат дала модель дерева решений (DecisionTreeClassifier) с максимальной глубиной 11, количество объектов на 1 "листе" 7, а минимальное количество объектов на узле для разделения на классы - 9. Метрика ROC-AUC на тренировочных данных составила 87%, на тестовой 85%. Показатели относительно высокие, однако свидетельствуют о недообученности модели, т.е. текущих данных не хватило для более точного прогнозирования.
Оценка важности признаков показала:
Малозначимые признаки для модели: тип сервиса, длительность (т.е. количество дней с момента регистрации на сайте). Также модель не сочла значимыми почти все категории товаров, кроме Мелкой быовой техники и электроники. Ранее также отмечали большую разницу в количестве людей с данной любимой категорией среди покупателей с прежним и снизившимся уровнями покупательской активности.
Неожиданно, что выручка за препредыдущий месяц оказалась более значима для модели, чем за предыдущий. Выручку за текущий месяц модель и вовсе не учитывает.
Наиболее значимые признаки: количество просмотренных страниц за визит и количествено минут, проведенное на сайте, а также доля акционных покупок. При этом именно количество сраниц за визит является наиболее решающим фактором, важность практически 0.5.
Можем предположить, что ключевым фактором является не столько привлечение клиента зайти на сайт, сколько удержать его внимание и стимулировать его более длительное время потратить на изучение ассортимента. Согласно полученным данным, это может стать ключевым фактором при принятии решении о покупке.
Однако возможно это связано с неоптимальной работой алогоритмов поиска и предложения товаров на сайте, в следствие чего покупателю необходимо больше времени на принятие решения.
Тип сервиса и вовсе, насколько можем судить, не оказывает существенного влияния на покупательскую активность, как минимум в разрезе имеющихся данных. Соответственно, вероятно, в текущем виде он или не предоставляет достаточного количества преимуществ для постоянных покупателей(т.е. не работает на удержание) и носит номинальный характер, или же не влияет на объем покупок в целом (например, касается сопутствующих операций, такие как визуальные изменения сайта (ночной/дневной режим), псевдо закрытые распродажи и прочее). Следовательно, необходимо либо переработать значимость статусов, либо же не учитывать их в анализе.
В дальнейшем рекомендовано также пересмотреть данные, на которых обучается модель с целью устранения задвоения данных (например, время пребывания на сайте), а также оценить, какие из еще имеющихся данных у компании могут быть более полезными при анализе с учетом уже полученных предварительных результатов.
Выделили 3 группы покупателей в зависимости от объема прибыли Low, Normal и High.
Для анализа была выбрана группа Low, которая обычно включает в себя новых и уходящих покупателей, приносящи малую прибыль за счет малых объемов покупок.
Однако по итогу анализа выявлено, что причиной низкой прибыли является низкая рентабельность продаж, т.е. при высоких показателях выручки (следовательно, и объемах) компания недополучает прибыль.
Это может быть связано как с завышенными тратами (прямыми и сопутствующими), не заложенными в цену, так и с неоптимальной ценой товара. Т.е. ценовая стратегия на такие товары и/или клиентов (если по итогу точечного анализа самих клиентов будет выявлено наличие среди них оптовых покупателей, для которых устанавливаются слишком высокие скидки) неоптимальна и требует пересмотра.
Либо же итоговый более глубокий анализ ценовой стратегии данной категории может показать, что это "имиджевые затраты", т.е. компания сознательно идет на недополучение прибыли с данной категории клиентов с целью, например, непрямой рекламы (например, поставка по низким ценам товаров социально значимым компаниям, таким как детские сады, школы). В таком случае следует оценить, насколько данные о таких клиентах необходимы при построении модели прогноза снижения или сохранения уровня покупательской активности.
По итогу анализа сегмента клиентов с низкой рентабельностью продаж, но высокими рисками снижения активности можем сделать вывод о том, что:
В категории Кухонной посуды наибольшая доля акционных покупок у клиентов (почти 94%) при минимальной из всех ROS 5,8%. Вероятно, низкая рентабельность вызвана чрезмерным количеством купленных по акции товаров, т.к. выручка при этом не снизилась в сравнении с предыдущими периодами.
По 2 из 3 самых популярных категорий (Товары для детей и Домашний текстиль) доля акционных товаров также достаточно значима (близко к 40%).
Рекомендуется проведение более сложных рекламных акций. Т.е. не просто снижение цены на определенный период времени, а предоставление, например, промокодов за оставленные отзывы на ранее приобретенные товары или предоставление скидок/подарков при покупке определенных товаров и/или на определенную сумму.
Потенциальный риск: потеря части клиентов (либо снижение их выручки).
Рассматриваемая выгода: рост активности остальных клиентов, компенсация потерь ростом выручки и прибыли за счет других клиентов (т.к. в таком случае кленту сложнее расчитать размер получаемой выгоды, что позволяет в совокупности уменьшить размер реальной скидки для клиентов).
